# Portworx on Azure module

Module to provision portworx on azure


## Software dependencies

The module depends on the following software components:

### Terraform version

- \>= v0.15

### Terraform providers


- azure (hashicorp/azurerm)

### Module dependencies


- cluster - [github.com/cloud-native-toolkit/terraform-ocp-login.git](https://github.com/cloud-native-toolkit/terraform-ocp-login.git) (>= 1.2.4)

## Example usage

```hcl
module "azure-portworx" {
  source = "github.com/cloud-native-toolkit/terraform-azure-portworx"

  azure_client_id = var.azure_client_id
  azure_client_secret = var.azure_client_secret
  azure_subscription_id = var.azure_subscription_id
  azure_tenant_id = var.azure_tenant_id
  cluster_config_file = module.cluster.config_file_path
  cluster_type = var.azure-portworx_cluster_type
  default_block_storage_class = var.azure-portworx_default_block_storage_class
  default_file_storage_class = var.azure-portworx_default_file_storage_class
  default_rwo_storage_class = var.azure-portworx_default_rwo_storage_class
  default_rwx_storage_class = var.azure-portworx_default_rwx_storage_class
  disk_size = var.azure-portworx_disk_size
  enable_encryption = var.azure-portworx_enable_encryption
  kvdb_disk_size = var.azure-portworx_kvdb_disk_size
  portworx_spec = var.portworx_spec
  portworx_spec_file = var.portworx_spec_file
  provision = var.azure-portworx_provision
  px_enable_csi = var.azure-portworx_px_enable_csi
  px_enable_monitoring = var.azure-portworx_px_enable_monitoring
}

```

## Module details

### Inputs

| Name | Description | Required | Default | Source |
|------|-------------|---------|----------|--------|
| provision | If set to true installs Portworx on the given cluster | false | true |  |
| azure_subscription_id | The subscription id of the Azure account where the OpenShift cluster has been provisioned | true |  |  |
| azure_tenant_id | The tenant id of the Azure account where the OpenShift cluster has been provisioned | true |  |  |
| azure_client_id | The client id used to access the Azure account | true |  |  |
| azure_client_secret | The client secret used to access the Azure account | true |  |  |
| cluster_type | Type of OCP cluster on Azure (ARO | IPI) | false | ARO |  |
| disk_size | Disk size for each Portworx volume | false | 1000 |  |
| kvdb_disk_size |  | false | 150 |  |
| px_enable_monitoring | Enable monitoring on PX | false | true |  |
| px_enable_csi | Enable CSI on PX | false | true |  |
| cluster_config_file | Cluster config file for Kubernetes cluster. | true |  | cluster.config_file_path |
| portworx_spec_file | The path to the file that contains the yaml spec for the Portworx config. Either the `portworx_spec_file` or `portworx_spec` must be provided. The instructions for creating this configuration can be found at https://github.com/cloud-native-toolkit/terraform-azure-portworx/blob/main/PORTWORX_CONFIG.md | true |  |  |
| portworx_spec | The yaml spec for the Portworx config. Either the `portworx_spec_file` or `portworx_spec` must be provided. The instructions for creating this configuration can be found at https://github.com/cloud-native-toolkit/terraform-azure-portworx/blob/main/PORTWORX_CONFIG.md | true |  |  |
| enable_encryption | Flag indicating portworx volumes should be encrypted | true |  |  |
| default_rwx_storage_class | The default storage class that should be used for RWX volumes | false | portworx-rwx-gp3-sc |  |
| default_rwo_storage_class | The default storage class that should be used for RWO volumes | false | portworx-gp3-sc |  |
| default_file_storage_class | The default storage class that should be used for file volumes | false | portworx-gp3-sc |  |
| default_block_storage_class | The default storage class that should be used for block volumes | false | managed-premium |  |

### Outputs

| Name | Description |
|------|-------------|
| default_rwx_storage_class | Default read-write-many storage class |
| rwx_storage_class |  |
| rwo_storage_class |  |
| file_storage_class |  |
| block_storage_class |  |
| storage_classes_provided |  |

## Resources

- [Documentation](https://operate.cloudnativetoolkit.dev)
- [Module catalog](https://modules.cloudnativetoolkit.dev)

> License: Apache License 2.0 | Generated by iascable (3.2.2)
